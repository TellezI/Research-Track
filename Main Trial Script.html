<!DOCTYPE html>
<html>
  <head>
    <title>Project V2.0</title>
    <script src="jspsych.js"></script>
    <script src="jspsych-html-keyboard-response.js"></script>
    <link href="jspsych.css" rel="stylesheet" type="text/css"></link>
    <script src="jspsych-image-keyboard-response.js"></script>
    <script src="jspsych-call-function.js"></script>
    <script src="input_key_function.js"></script>

  </head>
  <p id="demo"></p>
  <body></body>
  <script>


//---------------------------------------------------------------------------------------------------------------------
var m=0;
const z = new Array(4);
const matrix = [
                 [0,1,0,0,2,0],
                 [0,0,1,0,0,2],
                 [2,0,0,1,0,0],
                 [0,2,0,0,1,0],
                 [0,0,2,0,0,1],
                 [1,0,0,2,0,0]
               ];


var initialState = 0;
var keyinputs = [[2],[2], [1], [1]];
//var keyinputs = new Array(4);
var all_states = [initialState];
var tmp = matrix[initialState];
var tmp_state = [initialState];
var flag = 0;
var tmppath = all_states;
//---------------------------------------------------------------------------------------------------------------------
      var trials = [];
      var timeline = [];
      var images = [
      "1.png", "2.png", "3.png", "4.png",
      "5.png", "6.png"
      ];

      var instructions = {
      type: "html-keyboard-response",
      stimulus: "<p>Waiting for the inputs</p> "+
      "Press the keys F or J to select your path.</p> " +
      "<p>You can only choose 4 inputs.</p>" +
      "<p>Then press Spacebar to confirm.</p>" +
      "<p>The images will be displayed </p> ",
      choices: [32],
      post_trial_gap: 1000
      };
      timeline.push(instructions);

      var evaluation = function (){
          for (var i = 0; i < all_states.length;) {
            var tmppath = all_states[i];
            i++}
          }


      var callFunct = {
          type: 'call-function',
          func: evaluation
      }
      timeline.push(callFunct);


      var block = {
        type: 'image-keyboard-response',
        //choices: ['m'],
        choices: jsPsych.NO_KEYS,
        prompt: '<p>Display of images.</p>',
        stimulus: function (){
              return images[tmppath[0]];
            },
        trial_duration: function(){
          return jsPsych.randomization.sampleWithoutReplacement([1000], 1)[0];
        },
        on_finish: function(data) {
          if (data.key_press == 40) {
            jsPsych.endCurrentTimeline();
          }},
      }
      timeline.push(block);

      var block2 = {
        type: 'image-keyboard-response',
        //choices: ['m'],
        choices: jsPsych.NO_KEYS,
        prompt: '<p>Display of images.</p>',
        stimulus: function (){
              return images[tmppath[1]];
            },
        trial_duration: function(){
          return jsPsych.randomization.sampleWithoutReplacement([1000], 1)[0];},
        on_finish: function(data) {
          if (data.key_press == 40) {
            jsPsych.endCurrentTimeline();
          }},
      }
      timeline.push(block2);

      var block3 = {
        type: 'image-keyboard-response',
        //choices: ['m'],
        choices: jsPsych.NO_KEYS,
        prompt: '<p>Display of images.</p>',
        stimulus: function (){
              return images[tmppath[2]];
            },
        trial_duration: function(){
          return jsPsych.randomization.sampleWithoutReplacement([1000], 1)[0];},
        on_finish: function(data) {
          if (data.key_press == 40) {
            jsPsych.endCurrentTimeline();
          }},
      }
      timeline.push(block3);

      var block4 = {
        type: 'image-keyboard-response',
        //choices: ['m'],
        choices: jsPsych.NO_KEYS,
        prompt: '<p>Display of images.</p>',
        stimulus: function (){
              return images[tmppath[3]];
            },
        trial_duration: function(){
          return jsPsych.randomization.sampleWithoutReplacement([1000], 1)[0];
        },
        on_finish: function(data) {
          if (data.key_press == 40) {
            jsPsych.endCurrentTimeline();
          }},
      }
      timeline.push(block4);

      var block5 = {
        type: 'image-keyboard-response',
        //choices: ['m'],
        choices: jsPsych.NO_KEYS,
        prompt: '<p>Display of images.</p>',
        stimulus: function (){
              return images[tmppath[4]];
            },
        trial_duration: function(){
          return jsPsych.randomization.sampleWithoutReplacement([1000], 1)[0];
        },
        on_finish: function(data) {
          if (data.key_press == 40) {
            jsPsych.endCurrentTimeline();
          }},
      }
      timeline.push(block4);



      var after_block = {
        type: 'html-keyboard-response',
        stimulus: '<p>The trial is finished.</p>'+
        '<p>Press any key to view the results.</p>',
        is_html: true
      }
      timeline.push(after_block);

      jsPsych.init({
        timeline: timeline,
        on_finish: function() {
          jsPsych.data.displayData();
        }
      });

</script>
</html>
